<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Tracker - Home</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background: #f5f5f5; 
            text-align: center;
            padding-top: 50px;
        }
        h1 { 
            margin-bottom: 30px; 
            color: #333;
        }
        .menu {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        button {
            width: 150px;
            height: 70px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.3s;
        }
        button:hover { 
            opacity: 0.9; 
        }
        .buy { background: #4CAF50; color: white; }
        .sell { background: #f44336; color: white; }
        .view { background: aqua; color: white; }

        .view a{
            text-decoration: none;
        }
        
        /* Form Styles */
        .form-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            width: 400px;
            margin: 20px auto 150px auto; 
            text-align: center;
            display: none;
        }
        .form-title { margin-bottom: 20px; color: #333; }
        .form-group { margin-bottom: 15px; text-align: left; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        input, select {
            width: 100%;
            padding: 10px;
            padding-right: 35px; 
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 14px;
            line-height: 1.5;
            appearance: none;
            background-color: white;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23333' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            box-sizing: border-box;
            margin-bottom: 40px; 
        }
        .form-btn {
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
        }
        .save { background: #4CAF50; color: white; }
        .back { background: #2196F3; color: white; margin-top: 15px; }
        .message {
            margin-top: 15px;
            font-weight: bold;
            padding: 10px;
            border-radius: 4px;
            display: none;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>
    <h1>Stock Tracker</h1>
    
    <div class="menu">
        <button class="buy" onclick="showForm('buy')">Buy</button>
        <button class="sell" onclick="showForm('sell')">Sell</button>
        <button class="View" onclick="showForm('View')" style="background-color: aqua;">
            <a href="file.html" style="text-decoration: none; color: black;">View</a>
        </button>
    </div>

    <!-- Buy Form -->
    <div id="buyForm" class="form-container">
        <h2 class="form-title">Buy Product</h2>
        <div class="form-group">
            <label for="buyProduct">Select Product:</label>
            <select id="buyProduct">
                <option value="">-- Select Product --</option>
                <option value="Meghna Regin">Meghna Regin</option>
                <option value="CGPC Regin">CGPC Regin</option>
                <option value="Sg-5 Regin">Sg-5 Regin</option>
                <option value="Fresh Calcium">Fresh Calcium</option>
                <option value="Tkn-1">Tkn-1</option>
                <option value="Picmic">Picmic</option>
                <option value="Thana-2">Thana-2</option>
                <option value="Stearic">Stearic</option>
                <option value="Kizar">Kizar</option>
                <option value="Moom">Moom</option>
                <option value="Baluchor">Baluchor</option>
                <option value="Kn-500">Kn-500</option>
                <option value="Titi">Titi</option>
                <option value="ACR">ACR</option>
                <option value="CPE">CPE</option>
                <option value="Turoushko">Turoushko</option>
                <option value="Hurstalec">Hurstalec</option>
            </select>
        </div>
        <div class="form-group">
            <label for="buyDate">Date:</label>
            <input type="date" id="buyDate">
        </div>
        <div class="form-group">
            <label for="buyFrom">Buy From (Who):</label>
            <input type="text" id="buyFrom" placeholder="Shop/Person">
        </div>
        <div class="form-group">
            <label for="buyQuantity">Quantity:</label>
            <input type="number" id="buyQuantity" placeholder="Enter quantity" min="1">
        </div>
        <button class="form-btn save" onclick="saveBuy()">Save Purchase</button>
        <button class="form-btn back" onclick="showForm('home')">Back to Home</button>
        <div id="buyMessage" class="message"></div>
    </div>

    <!-- Sell Form -->
    <div id="sellForm" class="form-container">
        <h2 class="form-title">Sell Product</h2>
        <div class="form-group">
            <label for="sellProduct">Select Product:</label>
            <select id="sellProduct">
                <option value="">-- Select Product --</option>
                <option value="Meghna Regin">Meghna Regin</option>
                <option value="CGPC Regin">CGPC Regin</option>
                <option value="Sg-5 Regin">Sg-5 Regin</option>
                <option value="Fresh Calcium">Fresh Calcium</option>
                <option value="Tkn-1">Tkn-1</option>
                <option value="Picmic">Picmic</option>
                <option value="Thana-2">Thana-2</option>
                <option value="Stearic">Stearic</option>
                <option value="Kizar">Kizar</option>
                <option value="Moom">Moom</option>
                <option value="Baluchor">Baluchor</option>
                <option value="Kn-500">Kn-500</option>
                <option value="Titi">Titi</option>
                <option value="ACR">ACR</option>
                <option value="CPE">CPE</option>
                <option value="Turoushko">Turoushko</option>
                <option value="Hurstalec">Hurstalec</option>
            </select>
        </div>
        <div class="form-group">
            <label for="sellDate">Date:</label>
            <input type="date" id="sellDate">
        </div>
        <div class="form-group">
            <label for="billNumber">Bill Number:</label>
            <input type="text" id="billNumber" placeholder="Enter bill number">
        </div>
        <div class="form-group">
            <label for="sellQuantity">Quantity:</label>
            <input type="number" id="sellQuantity" placeholder="Enter quantity" min="1">
        </div>
        <button class="form-btn save" onclick="saveSell()">Save Sale</button>
        <button class="form-btn back" onclick="showForm('home')">Back to Home</button>
        <div id="sellMessage" class="message"></div>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx-lZimRs3U_38Xlb4giFCTxDQgw9Oqh9PMxBkeELIQfChVWo63C1tSHPqcdTBM4Z07bw/exec"; // ðŸ”¹ replace with your Apps Script web app URL

        // Prefill today's date
        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date().toISOString().split('T')[0];
            if (!document.getElementById('buyDate').value)  document.getElementById('buyDate').value  = today;
            if (!document.getElementById('sellDate').value) document.getElementById('sellDate').value = today;
        });

        function showForm(formType) {
            document.querySelectorAll('.form-container').forEach(form => {
                form.style.display = 'none';
            });
            if (formType === 'buy') {
                document.getElementById('buyForm').style.display = 'block';
            } else if (formType === 'sell') {
                document.getElementById('sellForm').style.display = 'block';
            }
        }

        function showMessage(elementId, message, isSuccess) {
            const messageElement = document.getElementById(elementId);
            messageElement.textContent = message;
            messageElement.className = isSuccess ? 'message success' : 'message error';
            messageElement.style.display = 'block';
            setTimeout(() => { messageElement.style.display = 'none'; }, 5000);
        }

        // âœ… Send JSON instead of subject/body
        function sendViaAppsScript(data) {
            return fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify(data),
                headers: { "Content-Type": "application/json" }
            });
        }

        function saveBuy() {
            const product = document.getElementById('buyProduct').value;
            const date    = document.getElementById('buyDate').value;
            const from    = document.getElementById('buyFrom').value.trim();
            const qty     = document.getElementById('buyQuantity').value;

            if (!product || !date || !from || !qty || Number(qty) < 1) {
                showMessage('buyMessage', "Please fill all fields!", false);
                return;
            }

            const data = {
                type: "Purchase",
                product,
                date,
                from,
                quantity: qty
            };

            sendViaAppsScript(data)
              .then(() => {
                  showMessage('buyMessage', "Purchase saved & email sent!", true);
                  document.getElementById('buyProduct').value = "";
                  document.getElementById('buyFrom').value = "";
                  document.getElementById('buyQuantity').value = "";
              })
              .catch(() => showMessage('buyMessage', "Network error. Please try again.", false));
        }

        function saveSell() {
            const product = document.getElementById('sellProduct').value;
            const date    = document.getElementById('sellDate').value;
            const bill    = document.getElementById('billNumber').value.trim();
            const qty     = document.getElementById('sellQuantity').value;

            if (!product || !date || !bill || !qty || Number(qty) < 1) {
                showMessage('sellMessage', "Please fill all fields!", false);
                return;
            }

            const data = {
                type: "Sell",
                product,
                date,
                bill,
                quantity: qty
            };

            sendViaAppsScript(data)
              .then(() => {
                  showMessage('sellMessage', "Sale saved & email sent!", true);
                  document.getElementById('sellProduct').value = "";
                  document.getElementById('billNumber').value = "";
                  document.getElementById('sellQuantity').value = "";
              })
              .catch(() => showMessage('sellMessage', "Network error. Please try again.", false));
        }
    </script>
</body>
</html>
